module.exports=[47019,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(83469),e=a.i(50944),f=a.i(60246);let g=(0,a.i(60137).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var h=a.i(14548),i=a.i(92e3),j=a.i(16201),k=a.i(96221),l=a.i(24722);function m(){let{isAuthenticated:a,url:m,username:n,password:o,isLoading:p}=(0,d.useAuth)(),q=(0,e.useRouter)(),[r,s]=(0,c.useState)({name:"",description:"",owner:"",email:"",capabilities:"",members:""}),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)("single"),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),H=["SystemAdministrator","ApplicationAdministrator","IdentityAdministrator","RoleAdministrator","AccessManager","Auditor","BatchRequestAdministrator","BusinessRoleAdministrator","CertificationAdministrator","ComplianceOfficer","ManagedAttributeProvisioningAdmin","ManagedAttributePropertyAdmin","EntitlementRoleAdministrator","FormAdministrator","FullAccessAdminConsole","HelpDesk","IdentityCorrelationAdministrator","IdentityRequestAdministrator","ITRoleAdministrator","OrganizationalRoleAdministrator","PasswordAdministrator","PluginAdministrator","PolicyAdministrator","RuleAdministrator","SCIMExecutor","SignOffAdministrator","SyslogAdministrator","TaskResultsViewer","ViewAdminConsole","WebServicesExecutor","WorkgroupAdministrator","WorkItemAdministrator"].sort(),I=a=>{let b,c=r.capabilities?r.capabilities.split(",").map(a=>a.trim()).filter(Boolean):[];b=c.includes(a)?c.filter(b=>b!==a):[...c,a],s({...r,capabilities:b.join(",")})},J=r.capabilities?r.capabilities.split(",").map(a=>a.trim()).filter(Boolean):[],K=async a=>{a.preventDefault(),E(!0),u(null);try{let a=[{key:"workgroupName",value:r.name},{key:"description",value:r.description},{key:"ownerName",value:r.owner},{key:"email",value:r.email},{key:"capabilities",value:r.capabilities},{key:"members",value:r.members}],b=await fetch("/api/workflow/launch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:m,username:n,password:o,workflowName:"CreateWorkgroup",input:a})}),c=await b.json();if(c.success){let a="Workflow launched successfully.";if(c.launchResult&&c.launchResult.attributes){let b=c.launchResult.attributes.find(a=>"result"===a.key);b&&(a=b.value)}a.startsWith("Error")?u({success:!1,message:a}):(u({success:!0,message:a}),s({name:"",description:"",owner:"",email:"",capabilities:"",members:""}),G(!1))}else u({success:!1,message:c.error||"API Error"})}catch(a){u({success:!1,message:a.message})}finally{E(!1)}},L=async a=>{let b=(await a.text()).split("\n"),c=b[0].split(",").map(a=>a.trim()),d=[];for(let a=1;a<b.length;a++){if(!b[a].trim())continue;let e=b[a].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(e&&e.length>0){let a={};c.forEach((b,c)=>{let d=e[c]?e[c].trim():"";d.startsWith('"')&&d.endsWith('"')&&(d=(d=d.slice(1,-1)).replace(/""/g,'"')),a[b]=d}),d.push(a)}}return d},M=async()=>{if(x){E(!0),C([]),A({total:0,current:0,success:0,fail:0});try{let a=await L(x);A({total:a.length,current:0,success:0,fail:0});let b=0,c=async a=>{let b=a.name||a.workgroupName||"Unknown",c=[{key:"workgroupName",value:a.name||a.workgroupName},{key:"description",value:a.description},{key:"ownerName",value:a.owner||a.ownerName},{key:"email",value:a.email},{key:"capabilities",value:a.capabilities},{key:"members",value:a.members}];try{let a=await fetch("/api/workflow/launch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:m,username:n,password:o,workflowName:"CreateWorkgroup",input:c})}),d=await a.json();if(d.success){let a="Success";if(d.launchResult&&d.launchResult.attributes){let b=d.launchResult.attributes.find(a=>"result"===a.key);b&&(a=b.value)}a.startsWith("Error")?(C(c=>[`[FAIL] ${b}: ${a}`,...c]),A(a=>a?{...a,fail:a.fail+1,current:a.current+1}:null)):(C(c=>[`[OK] ${b}: ${a}`,...c]),A(a=>a?{...a,success:a.success+1,current:a.current+1}:null))}else throw Error(d.error||"Unknown API Error")}catch(a){C(c=>[`[FAIL] ${b}: ${a.message}`,...c]),A(a=>a?{...a,fail:a.fail+1,current:a.current+1}:null)}},d=async()=>{for(;b<a.length;){let d=b++;if(d>=a.length)break;await c(a[d])}},e=Array(Math.min(5,a.length)).fill(null).map(()=>d());await Promise.all(e)}catch(a){C(b=>[`[FATAL] Batch failed: ${a.message}`,...b])}finally{E(!1)}}};return p?(0,b.jsx)("main",{className:"min-h-screen bg-[#020617] flex items-center justify-center",children:(0,b.jsx)(k.Loader2,{className:"h-8 w-8 text-indigo-500 animate-spin"})}):a?(0,b.jsxs)("main",{className:"min-h-screen bg-[#020617] text-slate-100 font-sans selection:bg-indigo-500/30",children:[(0,b.jsx)("div",{className:"absolute top-0 left-0 w-full h-[500px] bg-gradient-to-b from-blue-950/20 to-transparent pointer-events-none"}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-6 relative z-10",children:[(0,b.jsxs)("div",{className:"mb-8 border-b border-white/5 pb-6 flex justify-between items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-extrabold bg-gradient-to-r from-white via-slate-200 to-slate-400 bg-clip-text text-transparent flex items-center gap-3",children:[(0,b.jsx)(f.Users,{className:"h-8 w-8 text-indigo-400"}),"single"===v?"Create Workgroup":"Batch Create Workgroups"]}),(0,b.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:"single"===v?"Create new Workgroups and assign initial members.":"Upload CSV to create multiple workgroups."})]}),(0,b.jsxs)("div",{className:"bg-slate-900 border border-slate-700 p-1 rounded-lg flex",children:[(0,b.jsx)("button",{onClick:()=>w("single"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${"single"===v?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"Single"}),(0,b.jsx)("button",{onClick:()=>w("batch"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${"batch"===v?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"Batch CSV"})]})]}),(0,b.jsx)("div",{className:"bg-slate-900/40 backdrop-blur-xl border border-white/10 p-8 rounded-2xl shadow-xl",children:"single"===v?(0,b.jsxs)("form",{onSubmit:K,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Workgroup Name *"}),(0,b.jsx)("input",{type:"text",value:r.name,onChange:a=>s({...r,name:a.target.value}),className:"w-full bg-slate-950/50 border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600",placeholder:"e.g., AD-Admins-WG",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Description"}),(0,b.jsx)("textarea",{value:r.description,onChange:a=>s({...r,description:a.target.value}),className:"w-full bg-slate-950/50 border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600 min-h-[80px]",placeholder:"Purpose of this workgroup..."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Owner Identity Name"}),(0,b.jsx)("input",{type:"text",value:r.owner,onChange:a=>s({...r,owner:a.target.value}),className:"w-full bg-slate-950/50 border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600",placeholder:"e.g., spadmin"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Group Email"}),(0,b.jsx)("input",{type:"email",value:r.email,onChange:a=>s({...r,email:a.target.value}),className:"w-full bg-slate-950/50 border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600",placeholder:"group@example.com"})]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Capabilities (Rights)"}),J.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:J.map(a=>(0,b.jsxs)("span",{className:"bg-indigo-500/20 text-indigo-300 border border-indigo-500/30 px-2 py-1 rounded text-xs flex items-center gap-1",children:[a,(0,b.jsx)("button",{type:"button",onClick:()=>I(a),className:"hover:text-white",children:"×"})]},a))}),(0,b.jsxs)("button",{type:"button",onClick:()=>G(!F),className:"w-full bg-slate-950/50 border border-slate-700 rounded-lg px-4 py-3 text-left text-slate-300 focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all flex justify-between items-center",children:[(0,b.jsx)("span",{children:0===J.length?"Select Capabilities...":`Selected ${J.length} capabilities`}),(0,b.jsx)("span",{className:"text-slate-500",children:"▼"})]}),F&&(0,b.jsx)("div",{className:"absolute z-50 mt-1 w-full bg-slate-900 border border-slate-700 rounded-lg shadow-2xl max-h-60 overflow-y-auto",children:H.map(a=>(0,b.jsxs)("div",{onClick:()=>I(a),className:`px-4 py-2 cursor-pointer text-sm flex items-center gap-2 hover:bg-slate-800 transition-colors ${J.includes(a)?"bg-indigo-900/30 text-indigo-300":"text-slate-300"}`,children:[(0,b.jsx)("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${J.includes(a)?"bg-indigo-500 border-indigo-500":"border-slate-600"}`,children:J.includes(a)&&(0,b.jsx)(j.CheckCircle,{className:"w-3 h-3 text-white"})}),a]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Members (Native Identity Names)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("textarea",{value:r.members,onChange:a=>s({...r,members:a.target.value}),className:"w-full bg-slate-950/50 border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600 min-h-[100px]",placeholder:"e.g., James.Smith, Linda.Johnson"}),(0,b.jsx)(g,{className:"absolute top-3 right-3 h-5 w-5 text-slate-600"})]}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Check comma-separated list of identity names."})]}),t&&(0,b.jsxs)("div",{className:`p-4 rounded-lg flex items-start gap-3 ${t.success?"bg-emerald-950/30 border border-emerald-500/20 text-emerald-400":"bg-rose-950/30 border border-rose-500/20 text-rose-400"}`,children:[t.success?(0,b.jsx)(j.CheckCircle,{className:"h-5 w-5 shrink-0"}):(0,b.jsx)(i.AlertCircle,{className:"h-5 w-5 shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:t.success?"Success":"Error"}),(0,b.jsx)("p",{className:"text-sm opacity-90",children:t.message})]})]}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)("button",{type:"submit",disabled:D,className:"w-full bg-gradient-to-r from-indigo-500 to-violet-500 hover:from-indigo-400 hover:to-violet-400 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-indigo-500/20 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"h-5 w-5 animate-spin"})," Creating..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Save,{className:"h-5 w-5"})," Create Workgroup"]})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"p-6 bg-slate-950/30 border border-dashed border-slate-700 rounded-xl text-center",children:[(0,b.jsxs)("label",{className:"block cursor-pointer",children:[(0,b.jsx)("span",{className:"text-indigo-400 font-medium",children:"Click to Upload CSV"}),(0,b.jsx)("input",{type:"file",className:"hidden",accept:".csv",onChange:a=>{a.target.files&&a.target.files[0]&&y(a.target.files[0])}}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Format: name, description, owner, email, capabilities, members"})]}),x&&(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2 text-emerald-400 bg-emerald-950/20 py-2 px-4 rounded-full text-sm font-mono",children:[(0,b.jsx)(l.FileSpreadsheet,{className:"h-4 w-4"})," ",x.name]})]}),z&&(0,b.jsxs)("div",{className:"bg-slate-950/50 rounded-xl p-6 border border-white/5 space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center text-sm mb-2",children:[(0,b.jsx)("span",{className:"text-slate-300 font-medium",children:"Batch Progress"}),(0,b.jsxs)("span",{className:"text-indigo-400",children:[z.current," / ",z.total]})]}),(0,b.jsx)("div",{className:"w-full bg-slate-800 rounded-full h-2.5 overflow-hidden",children:(0,b.jsx)("div",{className:"bg-gradient-to-r from-indigo-500 to-violet-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${z.current/z.total*100}%`}})}),(0,b.jsxs)("div",{className:"flex justify-between text-xs text-slate-500",children:[(0,b.jsxs)("span",{className:"text-emerald-400",children:["Success: ",z.success]}),(0,b.jsxs)("span",{className:"text-rose-400",children:["Failed: ",z.fail]})]})]}),B.length>0&&(0,b.jsx)("div",{className:"max-h-60 overflow-y-auto bg-black/40 rounded-lg p-4 font-mono text-xs space-y-1 border border-white/5",children:B.map((a,c)=>(0,b.jsx)("div",{className:a.includes("[FAIL]")?"text-rose-400":"text-emerald-400/80",children:a},c))}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)("button",{onClick:M,disabled:D||!x,className:"w-full bg-gradient-to-r from-indigo-500 to-violet-500 hover:from-indigo-400 hover:to-violet-400 text-white font-bold py-3 px-6 rounded-xl shadow-lg shadow-indigo-500/20 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"h-5 w-5 animate-spin"})," Processing Batch..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.FileSpreadsheet,{className:"h-5 w-5"})," Start Batch Creation"]})})})]})})]})]}):(q.push("/"),null)}a.s(["default",()=>m],47019)}];

//# sourceMappingURL=app_workgroup_page_tsx_02f0e850._.js.map