(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},40160,e=>{"use strict";let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],40160)},7573,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(37322),l=e.i(75254);let n=(0,l.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var o=e.i(31245),r=e.i(31278),i=e.i(40160),d=e.i(64659);let c=(0,l.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function u(){let{isAuthenticated:e,url:l,username:u,password:p}=(0,a.useAuth)(),[h,m]=(0,s.useState)(""),[f,g]=(0,s.useState)([{role:"assistant",content:"Hello! I can help you run IdentityIQ reports. Try asking:\n- \"Members of 'Admins' group\"\n- \"Access for user 'James.Smith'\""}]),[x,b]=(0,s.useState)(!1),[y,w]=(0,s.useState)([]);(0,s.useEffect)(()=>{e&&j()},[e]);let j=async()=>{try{let e=await fetch("/api/workflow/launch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:l,username:u,password:p,workflowName:"GetAllReports",input:[]})}),t=await e.json();if(t.success&&t.launchResult?.attributes){let e=t.launchResult.attributes.find(e=>"reportList"===e.key)?.value;e&&w(JSON.parse(e))}}catch(e){console.error("Failed to load reports",e)}},N=async()=>{if(!h.trim())return;let e={role:"user",content:h};g(t=>[...t,e]),m(""),b(!0);try{g(e=>[...e,{role:"assistant",content:"Thinking..."}]);let t=await fetch("/api/ai-reports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e.content,url:l,username:u,password:p})}),s=await t.json();if(s.success||s.launchResult){if(s.debug){let e=`ðŸ” **AI Debug Info**
**Query:** ${s.debug.query}
**Registry:** ${s.debug.registryCount} reports loaded
**Sample Reports:** ${s.debug.registrySample?.map(e=>e.name).join(", ")}
**AI Decision:**
- Report: ${s.debug.aiDecision?.reportName}
- Arguments: ${JSON.stringify(s.debug.aiDecision?.reportArgs,null,2)}`;g(t=>{let s=[...t];return"Thinking..."===s[s.length-1].content&&s.pop(),[...s,{role:"assistant",content:e,isDebug:!0,collapsed:!0}]})}await v(s,"AI Selected Report")}else g(e=>{let t=[...e];return"Thinking..."===t[t.length-1].content&&t.pop(),[...t,{role:"assistant",content:s.error||s.message||"I couldn't process that request."}]})}catch(e){g(t=>[...t,{role:"assistant",content:`Error: ${e.message}`}])}finally{b(!1)}},v=async(e,t)=>{g(e=>{let t=[...e];return"Thinking..."===t[t.length-1].content&&t.pop(),t});let s=null;if(e.launchResult?.attributes){let t=e.launchResult.attributes.find(e=>"launchResult"===e.key)?.value;t&&(s=JSON.parse(t))}else if(e.launchResult&&"string"==typeof e.launchResult)try{s=JSON.parse(e.launchResult)}catch(e){}if(s){let e=s.completionStatus,t=s.messages||[],a="";t.length>0&&(a="\n**Messages:** "+t.map(e=>"string"==typeof e?e:e&&"object"==typeof e?JSON.stringify(e):String(e)).join(", "));let l=s.fileName||"report.csv";if(s.fileContent)try{let t=atob(s.fileContent),a=Array(t.length);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);let n=new Uint8Array(a),o=new Blob([n],{type:s.contentType||"application/octet-stream"}),r=window.URL.createObjectURL(o),i=Math.round(o.size/1024);g(t=>[...t,{role:"assistant",content:`âœ… **Report Generated Successfully!**

**File:** ${l}
**Size:** ${i} KB
**Status:** ${e}`,downloadUrl:r,fileName:l}])}catch(e){g(t=>[...t,{role:"assistant",content:`Report completed but failed to process file: ${e}`}])}else g(t=>[...t,{role:"assistant",content:`Report finished with status: **${e}**${a}.
(No content returned - maybe no matches?)`}])}else g(e=>[...e,{role:"assistant",content:"Workflow launched, but no immediate result returned."}])};return(0,t.jsx)("main",{className:"min-h-screen bg-[#020617] text-slate-100 font-sans p-6 flex flex-col items-center",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl flex-1 flex flex-col bg-slate-900/50 border border-white/10 rounded-2xl overflow-hidden shadow-2xl",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-white/10 bg-slate-950/50 flex items-center gap-3",children:[(0,t.jsx)(o.Bot,{className:"h-6 w-6 text-indigo-400"}),(0,t.jsx)("h1",{className:"font-bold text-lg",children:"AI Report Assistant"}),(0,t.jsxs)("span",{className:"text-xs text-slate-500 ml-auto",children:[y.length," reports loaded"]})]}),(0,t.jsxs)("div",{className:"flex-1 p-6 overflow-y-auto space-y-4 custom-scrollbar",children:[f.map((e,s)=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[80%] p-4 rounded-2xl ${"user"===e.role?"bg-indigo-600 text-white rounded-br-none":"bg-slate-800 text-slate-200 rounded-bl-none border border-white/5"}`,children:[e.isDebug?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>{g(e=>e.map((e,t)=>t===s?{...e,collapsed:!e.collapsed}:e))},className:"flex items-center gap-2 text-sm font-medium text-indigo-300 hover:text-indigo-200 w-full text-left",children:[e.collapsed?(0,t.jsx)(d.ChevronDown,{className:"h-4 w-4"}):(0,t.jsx)(c,{className:"h-4 w-4"}),"ðŸ” AI Debug Info"]}),!e.collapsed&&(0,t.jsx)("div",{className:"mt-3 whitespace-pre-wrap text-xs text-slate-300 bg-slate-900/50 p-3 rounded border border-white/5",children:e.content})]}):(0,t.jsx)("div",{className:"whitespace-pre-wrap",children:e.content}),e.downloadUrl&&(0,t.jsxs)("button",{onClick:()=>{let t=document.createElement("a");t.href=e.downloadUrl,t.download=e.fileName||"report.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"mt-3 flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-medium transition-colors",children:[(0,t.jsx)(i.Download,{className:"h-4 w-4"}),"Download ",e.fileName]})]})},s)),x&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsxs)("div",{className:"bg-slate-800 p-4 rounded-2xl rounded-bl-none border border-white/5 flex items-center gap-2",children:[(0,t.jsx)(r.Loader2,{className:"h-4 w-4 animate-spin text-indigo-400"}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"Processing..."})]})})]}),(0,t.jsx)("div",{className:"p-4 bg-slate-950/50 border-t border-white/10",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),onKeyDown:e=>"Enter"===e.key&&N(),placeholder:"Describe the report you want...",className:"flex-1 bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500/50 outline-none",disabled:x}),(0,t.jsx)("button",{onClick:N,disabled:x||!h.trim(),className:"bg-indigo-600 hover:bg-indigo-500 text-white p-3 rounded-xl transition-colors disabled:opacity-50",children:(0,t.jsx)(n,{className:"h-5 w-5"})})]})})]})})}e.s(["default",()=>u],7573)}]);